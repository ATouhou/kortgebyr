function calc(){var e,t,n,r,i,s;oms=transactions*value;if(transactions>500){e=0;if(transactions<601)e=(transactions-500)*.5;else if(transactions<1001)e=50+(transactions-600)*.4;else if(transactions<3001)e=210+(transactions-1e3)*.3;else if(transactions<10001){e=810;e+=(transactions-3e3)*.25}else if(transactions<30001){e=2560;e+=(transactions-1e4)*.15}else{e=5560;e+=(transactions-3e4)*.1}PSP[4].fixedTransactionFee=e/(transactions-500)}oms<2e4?PSP[0].variableTransactionFee=3.4:oms<=8e4?PSP[0].variableTransactionFee=2.9:oms<=4e5?PSP[0].variableTransactionFee=2.7:oms<=8e5?PSP[0].variableTransactionFee=2.4:PSP[0].variableTransactionFee=1.9;if(value<=50)acquirer[0].fixedTransactionFee=.7;else if(value<=100)acquirer[0].fixedTransactionFee=1.1;else if(value<=500)acquirer[0].fixedTransactionFee=1.45;else{acquirer[0].fixedTransactionFee=1.45;acquirer[0].variableTransactionFee=.001}for(t=0;t<acquirer.length;t++){n=1;dankort===!0&&visamc===!0&&(acquirer[t].name!=="nets"?n=(100-dankortfrekvens)/100:n=dankortfrekvens/100);acquirer[t].transactionCosts=n*(transactions*acquirer[t].fixedTransactionFee+oms*(acquirer[t].variableTransactionFee/100));acquirer[t].totalCosts=acquirer[t].transactionCosts+acquirer[t].monthlyFee;console.log(acquirer[t].name+": "+acquirer[t].totalCosts)}for(t=0;t<PSP.length;t++){PSP[t].acquirer==undefined?PSP[t].transactionCosts=PSP[t].fixedTransactionFee*transactions+PSP[t].variableTransactionFee/100*oms:transactions>PSP[t].freeTransactions&&(PSP[t].transactionCosts=PSP[t].fixedTransactionFee*(transactions-PSP[t].freeTransactions));PSP[t].costs=PSP[t].monthlyFee+PSP[t].transactionCosts;PSP[t].totalCosts=PSP[t].costs;PSP[t].totalMonthlyFee=PSP[t].monthlyFee;PSP[t].totalSetupFee=PSP[t].setupFee;if(PSP[t].acquirer!==undefined){r=Number.POSITIVE_INFINITY;PSP[t].availableAcquirers.forEach(function(e,t){console.log("n="+e+", x="+t);if(e>0&&jcb===!1){i=acquirer[e].totalCosts;if(i<r){r=i;s=e}}else jcb===!0&&(s=2)});PSP[t].acquirer=s;PSP[t].costs=PSP[t].monthlyFee+PSP[t].transactionCosts;if(dankort===!0&&PSP[t].acquirer!==undefined){PSP[t].totalSetupFee+=acquirer[0].setupFee;PSP[t].totalMonthlyFee+=acquirer[0].monthlyFee;PSP[t].totalCosts+=acquirer[0].totalCosts}if(PSP[t].acquirer!==0&&visamc===!0){PSP[t].totalSetupFee+=acquirer[PSP[t].acquirer].setupFee;PSP[t].totalMonthlyFee+=acquirer[PSP[t].acquirer].monthlyFee;PSP[t].totalCosts+=acquirer[PSP[t].acquirer].totalCosts}}}PSP.sort(function(e,t){return t.totalCosts-e.totalCosts});build()}function build(){var e,t,n,r,i,s,o,u,a,f,l,c,h=document.getElementById("data");h.innerHTML="";for(t=0;t<PSP.length;t++){if(visamc===!0&&PSP[t].availableAcquirers==0){console.log(PSP[t].acquirer);continue}e=h.insertRow(0);n=e.insertCell(0);r=e.insertCell(1);i=e.insertCell(2);s=e.insertCell(3);o=e.insertCell(4);u=e.insertCell(5);a=e.insertCell(6);f="<div class='acquirer'>";l="";if(PSP[t].acquirer==undefined)PSP[t].cards.forEach(function(e){l+="<img src='cards/"+cards[e].logo+"' width='24' />"});else{if(dankort===!0&&PSP[t].acquirer!==undefined){f+="<p style='background-position: 0 0px'></p>";l+="<img src='cards/dankort.png' height='16' />";PSP[t].cards.indexOf(1)>-1&&(l+="<img src='cards/edankort.png' height='16' />")}if(PSP[t].acquirer!==0&&visamc===!0){f+="<p style='background-position: 0 -"+16*(acquirer[PSP[t].acquirer].logo-1)+"px'></p>";acquirer[PSP[t].acquirer].cards.forEach(function(e){PSP[t].cards.indexOf(e)>-1&&(l+="<img src='cards/"+cards[e].logo+"' height='16' />")})}}f+="</div>";c="<a href='#' class='tooltip'><img src='tooltip.gif' /><span>Kortgebyr er de samlede omkostninger pr. gns. transaktion.</span></a>";n.innerHTML="<div class=psp><a href='http://"+PSP[t].link+"'><p style='background-position: 0 -"+32*(PSP[t].logo-1)+"px'></p>"+PSP[t].name+"</a></div>";r.innerHTML="<div class=kort>"+l+"</div>";i.innerHTML=f;s.innerHTML=Math.round(PSP[t].totalSetupFee)+" kr";o.innerHTML=Math.round(PSP[t].totalMonthlyFee)+" kr";u.innerHTML=Math.round(PSP[t].totalCosts)+" kr";a.innerHTML=(PSP[t].totalCosts/transactions).toFixed(2)+" kr"+c}};