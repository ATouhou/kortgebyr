function calc(){oms=transactions*value;if(transactions>500){var e=0;if(transactions<601)e=(transactions-500)*.5;else if(transactions<1001)e=50+(transactions-600)*.4;else if(transactions<3001)e=210+(transactions-1e3)*.3;else if(transactions<10001){e=810;e+=(transactions-3e3)*.25}else if(transactions<30001){e=2560;e+=(transactions-1e4)*.15}else{e=5560;e+=(transactions-3e4)*.1}PSP[4].fixedTransactionFee=e/(transactions-500)}oms<2e4?PSP[0].variableTransactionFee=3.4:oms<=8e4?PSP[0].variableTransactionFee=2.9:oms<=4e5?PSP[0].variableTransactionFee=2.7:oms<=8e5?PSP[0].variableTransactionFee=2.4:PSP[0].variableTransactionFee=1.9;if(value<=50)acquirer[0].fixedTransactionFee=.7;else if(value<=100)acquirer[0].fixedTransactionFee=1.1;else if(value<=500)acquirer[0].fixedTransactionFee=1.45;else{acquirer[0].fixedTransactionFee=1.45;acquirer[0].variableTransactionFee=.001}for(var t=0;t<acquirer.length;t++){var n=1;dankort===!0&&visamc===!0&&(acquirer[t].name!=="nets"?n=(100-dankortfrekvens)/100:n=dankortfrekvens/100);acquirer[t].transactionCosts=n*(transactions*acquirer[t].fixedTransactionFee+oms*(acquirer[t].variableTransactionFee/100));acquirer[t].totalCosts=acquirer[t].transactionCosts+acquirer[t].monthlyFee;console.log(acquirer[t].name+": "+acquirer[t].totalCosts)}for(var t=0;t<PSP.length;t++){PSP[t].acquirer==undefined?PSP[t].transactionCosts=PSP[t].fixedTransactionFee*transactions+PSP[t].variableTransactionFee/100*oms:transactions>PSP[t].freeTransactions&&(PSP[t].transactionCosts=PSP[t].fixedTransactionFee*(transactions-PSP[t].freeTransactions));PSP[t].costs=PSP[t].monthlyFee+PSP[t].transactionCosts;PSP[t].totalCosts=PSP[t].costs;PSP[t].totalMonthlyFee=PSP[t].monthlyFee;PSP[t].totalSetupFee=PSP[t].setupFee;if(PSP[t].acquirer!==undefined){var r=Number.POSITIVE_INFINITY,i,s;PSP[t].availableAcquirers.forEach(function(e,t){console.log("n="+e+", x="+t);if(e>0&&jcb===!1){i=acquirer[e].totalCosts;if(i<r){r=i;s=e}}else jcb===!0&&(s=2)});PSP[t].acquirer=s;PSP[t].costs=PSP[t].monthlyFee+PSP[t].transactionCosts;if(dankort===!0&&PSP[t].acquirer!==undefined){PSP[t].totalSetupFee+=acquirer[0].setupFee;PSP[t].totalMonthlyFee+=acquirer[0].monthlyFee;PSP[t].totalCosts+=acquirer[0].totalCosts}if(PSP[t].acquirer!==0&&visamc===!0){PSP[t].totalSetupFee+=acquirer[PSP[t].acquirer].setupFee;PSP[t].totalMonthlyFee+=acquirer[PSP[t].acquirer].monthlyFee;PSP[t].totalCosts+=acquirer[PSP[t].acquirer].totalCosts}}}PSP.sort(function(e,t){return t.totalCosts-e.totalCosts});build()}function build(){var e=document.getElementById("data"),t;e.innerHTML="";for(var n=0;n<PSP.length;n++){if(visamc===!0&&PSP[n].availableAcquirers==0){console.log(PSP[n].acquirer);continue}t=e.insertRow(0);var r=t.insertCell(0),i=t.insertCell(1),s=t.insertCell(2),o=t.insertCell(3),u=t.insertCell(4),a=t.insertCell(5),f=t.insertCell(6),l="<div class='acquirer'>",c="";if(PSP[n].acquirer==undefined)PSP[n].cards.forEach(function(e,t){c+="<img src='cards/"+cards[e].logo+"' width='24' />"});else{if(dankort===!0&&PSP[n].acquirer!==undefined){l+="<p style='background-position: 0 0px'></p>";c+="<img src='cards/dankort.png' height='16' />";PSP[n].cards.indexOf(1)>-1&&(c+="<img src='cards/edankort.png' height='16' />")}if(PSP[n].acquirer!==0&&visamc===!0){l+="<p style='background-position: 0 -"+16*(acquirer[PSP[n].acquirer].logo-1)+"px'></p>";acquirer[PSP[n].acquirer].cards.forEach(function(e,t){PSP[n].cards.indexOf(e)>-1&&(c+="<img src='cards/"+cards[e].logo+"' height='16' />")})}}l+="</div>";var h="<a href='#' class='tooltip'><img src='tooltip.gif' /><span>Kortgebyr er de samlede omkostninger pr. gns. transaktion.</span></a>";r.innerHTML="<div class=psp><a href='http://"+PSP[n].link+"'><p style='background-position: 0 -"+32*(PSP[n].logo-1)+"px'></p>"+PSP[n].name+"</a></div>";i.innerHTML="<div class=kort>"+c+"</div>";s.innerHTML=l;o.innerHTML=Math.round(PSP[n].totalSetupFee)+" kr";u.innerHTML=Math.round(PSP[n].totalMonthlyFee)+" kr";a.innerHTML=Math.round(PSP[n].totalCosts)+" kr";f.innerHTML=(PSP[n].totalCosts/transactions).toFixed(2)+" kr"+h}};